
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Symfony DataTables Bundle</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#installation" class="toc-h1 toc-link" data-title="Installation">Installation</a>
          </li>
          <li>
            <a href="#quickstart" class="toc-h1 toc-link" data-title="Quickstart">Quickstart</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#frontend-code" class="toc-h2 toc-link" data-title="Frontend code">Frontend code</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#configuration" class="toc-h1 toc-link" data-title="Configuration">Configuration</a>
          </li>
          <li>
            <a href="#core-concepts" class="toc-h1 toc-link" data-title="Core concepts">Core concepts</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#adapters" class="toc-h2 toc-link" data-title="Adapters">Adapters</a>
                  </li>
                  <li>
                    <a href="#columns" class="toc-h2 toc-link" data-title="Columns">Columns</a>
                  </li>
                  <li>
                    <a href="#datatable-types" class="toc-h2 toc-link" data-title="DataTable types">DataTable types</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#adapters-2" class="toc-h1 toc-link" data-title="Adapters">Adapters</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#doctrine-orm" class="toc-h2 toc-link" data-title="Doctrine ORM">Doctrine ORM</a>
                  </li>
                  <li>
                    <a href="#arrays" class="toc-h2 toc-link" data-title="Arrays">Arrays</a>
                  </li>
                  <li>
                    <a href="#implementing-your-own" class="toc-h2 toc-link" data-title="Implementing your own">Implementing your own</a>
                  </li>
              </ul>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='https://packagist.org/packages/omines/datatables-bundle'>Install from Packagist</a></li>
            <li><a href='https://github.com/omines/datatables-bundle'>Fork me on GitHub</a></li>
            <li><a href='https://github.com/omines/datatables-bundle/issues'>Report an issue</a></li>
            <li><a href='https://www.omines.nl/' title='Internetbureau Eindhoven'>Omines Full Service Internetbureau</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>This bundle provides convenient integration of the popular <a href="https://datatables.net/">DataTables</a> jQuery library
for realtime AJAX tables in your Symfony 3.3+ or 4.0+ application.</p>

<p>Designed to be fully pluggable there are no limits to the data sources you can display through this library, nor
are there any bounds on how they are displayed. In full <em>&#39;batteries included but replaceable&#39;</em> philosophy there are
ready made adapters for common use cases like Doctrine ORM, but they are trivial to replace or extend.</p>
<h1 id='installation'>Installation</h1>
<p>Recommended way of installing this library is through <a href="https://getcomposer.org/">Composer</a>.</p>

<p><code>composer require omines/datatables-bundle</code></p>

<p>Please ensure you are using Symfony 3.3 or later. Symfony Flex bindings are on their way.</p>
<pre class="highlight php"><code><span class="k">public</span> <span class="k">function</span> <span class="nf">registerBundles</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// After Symfony's own bundles 
</span>    <span class="k">new</span> <span class="nx">\Omines\DataTablesBundle\DataTablesBundle</span><span class="p">(),</span>
    <span class="c1">// Before your application bundles
</span><span class="p">}</span>
</code></pre>
<p>After installation you should register the bundle to your kernel, commonly <code>AppKernel.php</code>, before your
own bundles but after the required external bundles, such as <code>FrameworkBundle</code> and <code>TwigBundle</code>.</p>

<p>Run the <code>assets:install</code> command to deploy the included Javascript files to your application&#39;s public folder.</p>

<p><code>bin/console assets:install</code></p>

<aside class="notice">That last step is actually optional, as you can also load it through Assetic or WebPack, but a good starting point.</aside>
<h1 id='quickstart'>Quickstart</h1><pre class="highlight php"><code><span class="k">use</span> <span class="nx">Omines\DataTablesBundle\DataTablesTrait</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Omines\DataTablesBundle\Adapter\ArrayAdapter</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Omines\DataTablesBundle\Column\TextColumn</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MyController</span> <span class="k">extends</span> <span class="nx">Controller</span>
<span class="p">{</span>
    <span class="k">use</span> <span class="nx">DataTablesTrait</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">showAction</span><span class="p">(</span><span class="nx">Request</span> <span class="nv">$request</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$table</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">createDataTable</span><span class="p">()</span>
            <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">'firstName'</span><span class="p">,</span> <span class="nx">TextColumn</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
            <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">'lastName'</span><span class="p">,</span> <span class="nx">TextColumn</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
            <span class="o">-&gt;</span><span class="na">createAdapter</span><span class="p">(</span><span class="nx">ArrayAdapter</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="p">[</span>
                <span class="p">[</span><span class="s1">'firstName'</span> <span class="o">=&gt;</span> <span class="s1">'Donald'</span><span class="p">,</span> <span class="s1">'lastName'</span> <span class="o">=&gt;</span> <span class="s1">'Trump'</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">'firstName'</span> <span class="o">=&gt;</span> <span class="s1">'Barack'</span><span class="p">,</span> <span class="s1">'lastName'</span> <span class="o">=&gt;</span> <span class="s1">'Obama'</span><span class="p">],</span>
            <span class="p">])</span>
            <span class="o">-&gt;</span><span class="na">handleRequest</span><span class="p">(</span><span class="nv">$request</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="nv">$table</span><span class="o">-&gt;</span><span class="na">isCallback</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nv">$table</span><span class="o">-&gt;</span><span class="na">getResponse</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">render</span><span class="p">(</span><span class="s1">'list.html.twig'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'datatable'</span> <span class="o">=&gt;</span> <span class="nv">$table</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<p>This trivial bit of code in your controller prepares a fully functional DataTables instance for use.</p>

<p>The optional <code>DataTablesTrait</code> is included to expose convenience methods in your controller for
easy instantiation. The <code>createDataTable</code> function is used in this example. On the DataTable instance we 
add 2 columns of type <code>TextColumn</code>, and we bind it to an adapter providing a static array as the
source of the data.</p>

<p>The <code>handleRequest</code> function will take care of handling any callbacks, similar to how Symfony&#39;s Form component
works. If it turns out the request originated from a callback we let the table provide the controller response,
otherwise we render a template with the table provided as a parameter.</p>
<h2 id='frontend-code'>Frontend code</h2><pre class="highlight html tab-html"><code><span class="c">&lt;!-- Insert this where you want the table to appear --&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"presidents"</span><span class="nt">&gt;</span>Loading...<span class="nt">&lt;/div&gt;</span>

<span class="c">&lt;!-- Insert this at the end of your body element, but before the closing tag --&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"bundles/datatables/js/datatables.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">'#presidents'</span><span class="p">).</span><span class="nx">initDataTables</span><span class="p">({{</span> <span class="nx">datatable_settings</span><span class="p">(</span><span class="nx">datatable</span><span class="p">)</span> <span class="p">}});</span>
<span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre>
<p>In your Twig template, <code>list.html.twig</code> in the example, we need to ensure the HTML has a container element
ready to contain the table. During load its contents will be erased, so you can put a loading indicator in
there like we did here.</p>

<p>Then you include the Javascript deployed to your public folder, and run a single command on a jQuery
selection of the container element. The <code>datatable_settings</code> Twig function will render a compact JSON
string with the configured settings required for initialization.</p>

<p>And that&#39;s it, the library will take it from here and your table will be shown on your webpage!</p>
<h1 id='configuration'>Configuration</h1><pre class="highlight yaml tab-yaml"><code><span class="na">datatables</span><span class="pi">:</span>

    <span class="c1"># Load i18n data from DataTables CDN or locally</span>
    <span class="na">language_from_cdn</span><span class="pi">:</span>    <span class="s">true</span>

    <span class="c1"># Default HTTP method to be used for callbacks</span>
    <span class="na">method</span><span class="pi">:</span>               <span class="s">POST</span> <span class="c1"># One of "GET"; "POST"</span>

    <span class="c1"># Default options to load into DataTables</span>
    <span class="na">options</span><span class="pi">:</span>
        <span class="na">option</span><span class="pi">:</span>           <span class="s">value</span>           

    <span class="c1"># Where to persist the current table state automatically</span>
    <span class="na">persist_state</span><span class="pi">:</span>        <span class="s">fragment</span> <span class="c1"># One of "query"; "fragment"; "local"; "session"</span>

    <span class="c1"># Default service used to render templates, built-in TwigRenderer uses global Twig environment</span>
    <span class="na">renderer</span><span class="pi">:</span>             <span class="s">Omines\DataTablesBundle\Twig\TwigRenderer</span>

    <span class="c1"># Default template to be used for DataTables HTML</span>
    <span class="na">template</span><span class="pi">:</span>             <span class="s1">'</span><span class="s">@DataTables/datatable_html.html.twig'</span>

    <span class="c1"># Default parameters to be passed to the template</span>
    <span class="na">template_parameters</span><span class="pi">:</span>

        <span class="c1"># Default class attribute to apply to the root table elements</span>
        <span class="na">className</span><span class="pi">:</span>            <span class="s1">'</span><span class="s">table</span><span class="nv"> </span><span class="s">table-bordered'</span>

        <span class="c1"># If and where to enable the DataTables Filter module</span>
        <span class="na">columnFilter</span><span class="pi">:</span>         <span class="s">null</span> <span class="c1"># One of "thead"; "tfoot"; "both"; null</span>

    <span class="c1"># Default translation domain to be used</span>
    <span class="na">translation_domain</span><span class="pi">:</span>   <span class="s">messages</span>
</code></pre>
<p>Global configuration of the bundle is done in your Symfony config file. The default configuration is shown here,
and should be fine in most cases. Most settings can be overridden per table, but for most applications
you will want to make changes at the global level so they are applied everywhere, providing a uniform
look and feel.</p>

<p>The following settings exist at the configuration level:</p>

<table><thead>
<tr>
<th>Option</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>language_from_cdn</td>
<td>bool</td>
<td>Load i18n files from DataTables CDN or from Symfony Translations.</td>
</tr>
<tr>
<td>options</td>
<td>object</td>
<td>Default options that will be passed to DataTables clientside initialization.</td>
</tr>
<tr>
<td>method</td>
<td>string</td>
<td>Either <code>GET</code> or <code>POST</code> to indicate which HTTP method to use for callbacks.</td>
</tr>
<tr>
<td>renderer</td>
<td>string</td>
<td>Service used to render the table HTML, which must implement the <code>DataTableRendererInterface</code>.</td>
</tr>
<tr>
<td>template</td>
<td>string</td>
<td>Default template to be used for rendering the basic HTML table in your templates.</td>
</tr>
<tr>
<td>template_parameters</td>
<td>object</td>
<td>Default parameters to be passed to the template during rendering.</td>
</tr>
<tr>
<td>translation_domains</td>
<td>string</td>
<td>Default Symfony Translation Domain used where translations are used.</td>
</tr>
</tbody></table>

<p>All settings can be overridden on individual tables by calling the corresponding setter function,
ie. <code>setLanguageFromCDN(bool)</code>.</p>

<p>The <code>options</code> are passed (almost) verbatim to the DataTables clientside constructor. Refer to the
<a href="https://datatables.net/reference/option/">external documentation</a> below for details on individual
options. Only options which are meaningful to be defined serverside can be set at this level, so
setting callbacks and events is not possible. These are however easily set on the Javascript end.</p>
<h1 id='core-concepts'>Core concepts</h1>
<p>This chapter details various base building blocks used in the bundle.</p>
<h2 id='adapters'>Adapters</h2>
<p>Adapters are the core elements bridging DataTables functionality to their underlying data source.
Popular implementations for common data sources are provided, and more are welcomed.</p>

<p>An adapter is called by the bundle when a request for data has been formulated, including search
and sorting criteria, and returns a result set with metadata on record counts.</p>
<h2 id='columns'>Columns</h2>
<p>Column classes derive from <code>AbstractColumn</code>, and implement the transformations required to convert
raw data into output ready for rendering in a DataTable.</p>
<h2 id='datatable-types'>DataTable types</h2><pre class="highlight php"><code>    <span class="nv">$table</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">createDataTableFromType</span><span class="p">(</span><span class="nx">PresidentsTableType</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">handleRequest</span><span class="p">(</span><span class="nv">$request</span><span class="p">);</span>
</code></pre>
<p>Having the table configuration in your controller is convenient, but not practical for reusable or
extensible tables, or highly customized tables. In the example above we could also create a class
<code>DataTable\Type\PresidentsTableType</code> in our app bundle, and make it implement 
<code>Omines\DataTablesBundle\DataTableTypeInterface</code>. We can then use the code illustrated here to
instantiate the reusable class in the controller.</p>

<p>This ensures your controllers stay lean and short, and only delegate tasks. The first parameter
takes either a Fully Qualified Class Name (FQCN) to instantiate the class dynamically, or a
registered service with a <code>datatables.type</code> tag. Use a service if you need to inject dependencies
dynamically. When using Symfony&#39;s autoconfiguration the tag will be applied automatically.</p>

<p>Of course you can modify the base type to fit the controller&#39;s specific needs before calling 
<code>handleRequest</code>. Secondly, the <code>createDataTableFromType</code> function accepts an array as a second
argument which is passed to the type class for parametrized instantiation.</p>
<h1 id='adapters-2'>Adapters</h1>
<p>Ready-made adapters are supplied for easy integration with various data sources.</p>
<h2 id='doctrine-orm'>Doctrine ORM</h2><pre class="highlight php"><code><span class="k">use</span> <span class="nx">Omines\DataTablesBundle\Adapter\Doctrine\ORMAdapter</span><span class="p">;</span>

<span class="nv">$table</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">createDataTable</span><span class="p">()</span>
    <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">'firstName'</span><span class="p">,</span> <span class="nx">TextColumn</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">'lastName'</span><span class="p">,</span> <span class="nx">TextColumn</span><span class="o">::</span><span class="na">class</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">'company'</span><span class="p">,</span> <span class="nx">TextColumn</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="p">[</span><span class="s1">'field'</span> <span class="o">=&gt;</span> <span class="s1">'company.name'</span><span class="p">])</span>
    <span class="o">-&gt;</span><span class="na">createAdapter</span><span class="p">(</span><span class="nx">ORMAdapter</span><span class="o">::</span><span class="na">class</span><span class="p">,</span> <span class="p">[</span>
        <span class="s1">'entity'</span> <span class="o">=&gt;</span> <span class="nx">Employee</span><span class="o">::</span><span class="na">class</span><span class="p">,</span>
    <span class="p">]);</span>
</code></pre>
<p>If you have installed <code>doctrine/orm</code> and <code>doctrine/doctrine-bundle</code> you can use the provided <code>ORMAdapter</code>.
Assume a simple <code>Employee</code> table with some basic fields and a ManyToOne relationship to <code>Company</code> for
these examples.</p>

<p>Underneath a lot of &quot;magic&quot; is happening in this most simple of examples. The first 2 columns automatically
have their <code>field</code> option defaulted to the &quot;root entity&quot; of the adapter, with the field identical to their
name. The adapter itself did not get a query, and as such injected the <code>AutomaticQueryBuilder</code> supplied by
this bundle, which scans the metadata and automatically joins and selects the right data based on the fields.
Secondly, since no criteria processors were supplied a default <code>SearchCriteriaProvider</code> was injected to
apply global search to all mapped fields.</p>

<p>Of course, all of this is just convenient default. For more complex scenarios you can supply your own query
builders and criteria providers, and even chain them together to easily implement multiple slightly different
tables in your site.</p>
<h2 id='arrays'>Arrays</h2><h2 id='implementing-your-own'>Implementing your own</h2>
      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
