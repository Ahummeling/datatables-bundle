{% spaceless %}
    <script type="text/javascript">
        $(document).ready(function () {
            var defaults = {};
            var options = {{ options|json_encode(64)|raw }};

            var callbacks = {
                {% for callback in datatable.callbacks %}
                "{{ callback.type }}": {% include callback.template with callback.vars %},
                {% endfor %}
            };

            $.extend(defaults, options);
            $.extend(defaults, callbacks);

            var oTable = $('#{{ datatable.setting('name') }}')
            {% for event in datatable.events %}
                .on('{{ event.type }}', {% include event.template with event.vars %})
                {% endfor %}
                .DataTable(defaults)
            ;

            {% if datatable.option('searching') and datatable.setting('column_filter') != null %}
            var search = $.fn.dataTable.util.throttle(function (event) {
                if (event.type == "keyup") {
                    if (
                        event.keyCode == 37 ||
                        event.keyCode == 38 ||
                        event.keyCode == 39 ||
                        event.keyCode == 40 ||
                        event.keyCode == 16 ||
                        event.keyCode == 17 ||
                        event.keyCode == 18
                    )
                        return;
                }


                $('#{{ datatable.setting('name') }}')
                    .DataTable()
                    .column($(event.currentTarget).data("search-column-index"))
                    .search($(this).val()).draw();
            },  options.searchDelay );

            $('#{{ datatable.setting('name') }}').find("thead input, tfoot input")
                .on("keyup chnage", function() {
                    var index = $(this).data('search-column-index');
                    $('input[data-search-column-index=' + index + ']').val($(this).val());
                })
                .on("keyup change", search);

            $('#{{ datatable.setting('name') }}').find("thead select, tfoot select")
                .on("keyup change", function (event) {
                var searchValue = $(this).val();
                searchValue = searchValue ? searchValue.toString() : '';

                $('#{{ datatable.setting('name') }}')
                    .DataTable()
                    .column($(event.currentTarget).data("search-column-index"))
                    .search(searchValue).draw();
            });
            {% endif %}
        });
    </script>
{% endspaceless %}
